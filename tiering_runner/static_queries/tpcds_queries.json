{
    "01": [
        "WITH customer_total_return AS\n  (SELECT sr_customer_sk AS ctr_customer_sk,\n          sr_store_sk AS ctr_store_sk,\n          sum(sr_return_amt) AS ctr_total_return\n   FROM store_returns,\n        date_dim\n   WHERE sr_returned_date_sk = d_date_sk\n     AND d_year = 2000\n   GROUP BY sr_customer_sk,\n            sr_store_sk)\nSELECT c_customer_id\nFROM customer_total_return ctr1,\n     store,\n     customer\nWHERE ctr1.ctr_total_return >\n    (SELECT avg(ctr_total_return)*1.2\n     FROM customer_total_return ctr2\n     WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n  AND s_store_sk = ctr1.ctr_store_sk\n  AND s_state = 'TN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY c_customer_id\nLIMIT 100;"
    ],
    "03": [
        "SELECT dt.d_year,\n       item.i_brand_id brand_id,\n       item.i_brand brand,\n       sum(ss_ext_sales_price) sum_agg\nFROM date_dim dt,\n     store_sales,\n     item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manufact_id = 128\n  AND dt.d_moy=11\nGROUP BY dt.d_year,\n         item.i_brand,\n         item.i_brand_id\nORDER BY dt.d_year,\n         sum_agg DESC,\n         brand_id\nLIMIT 100;"
    ],
    "06": [
        "SELECT a.ca_state state,\n       count(*) cnt\nFROM customer_address a ,\n     customer c ,\n     store_sales s ,\n     date_dim d ,\n     item i\nWHERE a.ca_address_sk = c.c_current_addr_sk\n  AND c.c_customer_sk = s.ss_customer_sk\n  AND s.ss_sold_date_sk = d.d_date_sk\n  AND s.ss_item_sk = i.i_item_sk\n  AND d.d_month_seq =\n    (SELECT DISTINCT (d_month_seq)\n     FROM date_dim\n     WHERE d_year = 2001\n       AND d_moy = 1 )\n  AND i.i_current_price > 1.2 *\n    (SELECT avg(j.i_current_price)\n     FROM item j\n     WHERE j.i_category = i.i_category)\nGROUP BY a.ca_state\nHAVING count(*) >= 10\nORDER BY cnt,\n         a.ca_state\nLIMIT 100;"
    ],
    "07": [
        "SELECT i_item_id,\n       avg(ss_quantity) agg1,\n       avg(ss_list_price) agg2,\n       avg(ss_coupon_amt) agg3,\n       avg(ss_sales_price) agg4\nFROM store_sales,\n     customer_demographics,\n     date_dim,\n     item,\n     promotion\nWHERE ss_sold_date_sk = d_date_sk\n  AND ss_item_sk = i_item_sk\n  AND ss_cdemo_sk = cd_demo_sk\n  AND ss_promo_sk = p_promo_sk\n  AND cd_gender = 'M'\n  AND cd_marital_status = 'S'\n  AND cd_education_status = 'College'\n  AND (p_channel_email = 'N'\n       OR p_channel_event = 'N')\n  AND d_year = 2000\nGROUP BY i_item_id\nORDER BY i_item_id\nLIMIT 100;"
    ],
    "09": [
        "SELECT CASE\n           WHEN\n                  (SELECT count(*)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 1 AND 20) > 74129 THEN\n                  (SELECT avg(ss_ext_discount_amt)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 1 AND 20)\n           ELSE\n                  (SELECT avg(ss_net_paid)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 1 AND 20)\n       END bucket1,\n       CASE\n           WHEN\n                  (SELECT count(*)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 21 AND 40) > 122840 THEN\n                  (SELECT avg(ss_ext_discount_amt)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 21 AND 40)\n           ELSE\n                  (SELECT avg(ss_net_paid)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 21 AND 40)\n       END bucket2,\n       CASE\n           WHEN\n                  (SELECT count(*)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 41 AND 60) > 56580 THEN\n                  (SELECT avg(ss_ext_discount_amt)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 41 AND 60)\n           ELSE\n                  (SELECT avg(ss_net_paid)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 41 AND 60)\n       END bucket3,\n       CASE\n           WHEN\n                  (SELECT count(*)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 61 AND 80) > 10097 THEN\n                  (SELECT avg(ss_ext_discount_amt)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 61 AND 80)\n           ELSE\n                  (SELECT avg(ss_net_paid)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 61 AND 80)\n       END bucket4,\n       CASE\n           WHEN\n                  (SELECT count(*)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 81 AND 100) > 165306 THEN\n                  (SELECT avg(ss_ext_discount_amt)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 81 AND 100)\n           ELSE\n                  (SELECT avg(ss_net_paid)\n                   FROM store_sales\n                   WHERE ss_quantity BETWEEN 81 AND 100)\n       END bucket5\nFROM reason\nWHERE r_reason_sk = 1 ;"
    ],
    "10": [
        "SELECT cd_gender,\n       cd_marital_status,\n       cd_education_status,\n       count(*) cnt1,\n       cd_purchase_estimate,\n       count(*) cnt2,\n       cd_credit_rating,\n       count(*) cnt3,\n       cd_dep_count,\n       count(*) cnt4,\n       cd_dep_employed_count,\n       count(*) cnt5,\n       cd_dep_college_count,\n       count(*) cnt6\nFROM customer c,\n     customer_address ca,\n     customer_demographics\nWHERE c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN ('Rush County',\n                    'Toole County',\n                    'Jefferson County',\n                    'Dona Ana County',\n                    'La Porte County')\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS\n    (SELECT *\n     FROM store_sales,\n          date_dim\n     WHERE c.c_customer_sk = ss_customer_sk\n       AND ss_sold_date_sk = d_date_sk\n       AND d_year = 2002\n       AND d_moy BETWEEN 1 AND 1+3)\n  AND (EXISTS\n         (SELECT *\n          FROM web_sales,\n               date_dim\n          WHERE c.c_customer_sk = ws_bill_customer_sk\n            AND ws_sold_date_sk = d_date_sk\n            AND d_year = 2002\n            AND d_moy BETWEEN 1 AND 1+3)\n       OR EXISTS\n         (SELECT *\n          FROM catalog_sales,\n               date_dim\n          WHERE c.c_customer_sk = cs_ship_customer_sk\n            AND cs_sold_date_sk = d_date_sk\n            AND d_year = 2002\n            AND d_moy BETWEEN 1 AND 1+3))\nGROUP BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating,\n         cd_dep_count,\n         cd_dep_employed_count,\n         cd_dep_college_count\nORDER BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating,\n         cd_dep_count,\n         cd_dep_employed_count,\n         cd_dep_college_count\nLIMIT 100;"
    ],
    "13": [
        "SELECT avg(ss_quantity) ,\n       avg(ss_ext_sales_price) ,\n       avg(ss_ext_wholesale_cost) ,\n       sum(ss_ext_wholesale_cost)\nFROM store_sales ,\n     store ,\n     customer_demographics ,\n     household_demographics ,\n     customer_address ,\n     date_dim\nWHERE s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 2001 and((ss_hdemo_sk=hd_demo_sk\n                         AND cd_demo_sk = ss_cdemo_sk\n                         AND cd_marital_status = 'M'\n                         AND cd_education_status = 'Advanced Degree'\n                         AND ss_sales_price BETWEEN 100.00 AND 150.00\n                         AND hd_dep_count = 3)\n                        OR (ss_hdemo_sk=hd_demo_sk\n                            AND cd_demo_sk = ss_cdemo_sk\n                            AND cd_marital_status = 'S'\n                            AND cd_education_status = 'College'\n                            AND ss_sales_price BETWEEN 50.00 AND 100.00\n                            AND hd_dep_count = 1 )\n                        OR (ss_hdemo_sk=hd_demo_sk\n                            AND cd_demo_sk = ss_cdemo_sk\n                            AND cd_marital_status = 'W'\n                            AND cd_education_status = '2 yr Degree'\n                            AND ss_sales_price BETWEEN 150.00 AND 200.00\n                            AND hd_dep_count = 1)) and((ss_addr_sk = ca_address_sk\n                                                        AND ca_country = 'United States'\n                                                        AND ca_state IN ('TX', 'OH', 'TX')\n                                                        AND ss_net_profit BETWEEN 100 AND 200)\n                                                       OR (ss_addr_sk = ca_address_sk\n                                                           AND ca_country = 'United States'\n                                                           AND ca_state IN ('OR', 'NM', 'KY')\n                                                           AND ss_net_profit BETWEEN 150 AND 300)\n                                                       OR (ss_addr_sk = ca_address_sk\n                                                           AND ca_country = 'United States'\n                                                           AND ca_state IN ('VA', 'TX', 'MS')\n                                                           AND ss_net_profit BETWEEN 50 AND 250)) ;"
    ],
    "15": [
        "SELECT ca_zip,\n       sum(cs_sales_price)\nFROM catalog_sales,\n     customer,\n     customer_address,\n     date_dim\nWHERE cs_bill_customer_sk = c_customer_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND (SUBSTR(ca_zip, 1, 5) IN ('85669',\n                                '86197',\n                                '88274',\n                                '83405',\n                                '86475',\n                                '85392',\n                                '85460',\n                                '80348',\n                                '81792')\n       OR ca_state IN ('CA',\n                       'WA',\n                       'GA')\n       OR cs_sales_price > 500)\n  AND cs_sold_date_sk = d_date_sk\n  AND d_qoy = 2\n  AND d_year = 2001\nGROUP BY ca_zip\nORDER BY ca_zip\nLIMIT 100;"
    ],
    "16": [
        "SELECT count(DISTINCT cs_order_number) AS \"order count\",\n       sum(cs_ext_ship_cost) AS \"total shipping cost\",\n       sum(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales cs1,\n     date_dim,\n     customer_address,\n     call_center\nWHERE d_date BETWEEN '2002-02-01' AND cast('2002-04-02' AS date)\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'GA'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county = 'Williamson County'\n  AND EXISTS\n    (SELECT *\n     FROM catalog_sales cs2\n     WHERE cs1.cs_order_number = cs2.cs_order_number\n       AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\n  AND NOT EXISTS\n    (SELECT *\n     FROM catalog_returns cr1\n     WHERE cs1.cs_order_number = cr1.cr_order_number)\nORDER BY count(DISTINCT cs_order_number)\nLIMIT 100;"
    ],
    "17": [
        "SELECT i_item_id,\n       i_item_desc,\n       s_state,\n       count(ss_quantity) AS store_sales_quantitycount,\n       avg(ss_quantity) AS store_sales_quantityave,\n       stddev_samp(ss_quantity) AS store_sales_quantitystdev,\n       stddev_samp(ss_quantity)/avg(ss_quantity) AS store_sales_quantitycov,\n       count(sr_return_quantity) AS store_returns_quantitycount,\n       avg(sr_return_quantity) AS store_returns_quantityave,\n       stddev_samp(sr_return_quantity) AS store_returns_quantitystdev,\n       stddev_samp(sr_return_quantity)/avg(sr_return_quantity) AS store_returns_quantitycov,\n       count(cs_quantity) AS catalog_sales_quantitycount,\n       avg(cs_quantity) AS catalog_sales_quantityave,\n       stddev_samp(cs_quantity) AS catalog_sales_quantitystdev,\n       stddev_samp(cs_quantity)/avg(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales,\n     store_returns,\n     catalog_sales,\n     date_dim d1,\n     date_dim d2,\n     date_dim d3,\n     store,\n     item\nWHERE d1.d_quarter_name = '2001Q1'\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_quarter_name IN ('2001Q1',\n                            '2001Q2',\n                            '2001Q3')\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\n  AND d3.d_quarter_name IN ('2001Q1',\n                            '2001Q2',\n                            '2001Q3')\nGROUP BY i_item_id,\n         i_item_desc,\n         s_state\nORDER BY i_item_id,\n         i_item_desc,\n         s_state\nLIMIT 100;"
    ],
    "19": [
        "SELECT i_brand_id brand_id,\n       i_brand brand,\n       i_manufact_id,\n       i_manufact,\n       sum(ss_ext_sales_price) ext_price\nFROM date_dim,\n     store_sales,\n     item,\n     customer,\n     customer_address,\n     store\nWHERE d_date_sk = ss_sold_date_sk\n  AND ss_item_sk = i_item_sk\n  AND i_manager_id=8\n  AND d_moy=11\n  AND d_year=1998\n  AND ss_customer_sk = c_customer_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND SUBSTR(ca_zip, 1, 5) <> SUBSTR(s_zip, 1, 5)\n  AND ss_store_sk = s_store_sk\nGROUP BY i_brand,\n         i_brand_id,\n         i_manufact_id,\n         i_manufact\nORDER BY ext_price DESC,\n         i_brand,\n         i_brand_id,\n         i_manufact_id,\n         i_manufact\nLIMIT 100 ;"
    ],
    "25": [
        "SELECT i_item_id ,\n       i_item_desc ,\n       s_store_id ,\n       s_store_name ,\n       sum(ss_net_profit) AS store_sales_profit ,\n       sum(sr_net_loss) AS store_returns_loss ,\n       sum(cs_net_profit) AS catalog_sales_profit\nFROM store_sales ,\n     store_returns ,\n     catalog_sales ,\n     date_dim d1 ,\n     date_dim d2 ,\n     date_dim d3 ,\n     store ,\n     item\nWHERE d1.d_moy = 4\n  AND d1.d_year = 2001\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_moy BETWEEN 4 AND 10\n  AND d2.d_year = 2001\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\n  AND d3.d_moy BETWEEN 4 AND 10\n  AND d3.d_year = 2001\nGROUP BY i_item_id ,\n         i_item_desc ,\n         s_store_id ,\n         s_store_name\nORDER BY i_item_id ,\n         i_item_desc ,\n         s_store_id ,\n         s_store_name\nLIMIT 100;"
    ],
    "26": [
        "SELECT i_item_id,\n       avg(cs_quantity) agg1,\n       avg(cs_list_price) agg2,\n       avg(cs_coupon_amt) agg3,\n       avg(cs_sales_price) agg4\nFROM catalog_sales,\n     customer_demographics,\n     date_dim,\n     item,\n     promotion\nWHERE cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd_demo_sk\n  AND cs_promo_sk = p_promo_sk\n  AND cd_gender = 'M'\n  AND cd_marital_status = 'S'\n  AND cd_education_status = 'College'\n  AND (p_channel_email = 'N'\n       OR p_channel_event = 'N')\n  AND d_year = 2000\nGROUP BY i_item_id\nORDER BY i_item_id\nLIMIT 100;"
    ],
    "28": [
        "SELECT *\nFROM\n  (SELECT avg(ss_list_price) B1_LP,\n          count(ss_list_price) B1_CNT,\n          count(DISTINCT ss_list_price) B1_CNTD\n   FROM store_sales\n   WHERE ss_quantity BETWEEN 0 AND 5\n     AND (ss_list_price BETWEEN 8 AND 8+10\n          OR ss_coupon_amt BETWEEN 459 AND 459+1000\n          OR ss_wholesale_cost BETWEEN 57 AND 57+20)) B1,\n\n  (SELECT avg(ss_list_price) B2_LP,\n          count(ss_list_price) B2_CNT,\n          count(DISTINCT ss_list_price) B2_CNTD\n   FROM store_sales\n   WHERE ss_quantity BETWEEN 6 AND 10\n     AND (ss_list_price BETWEEN 90 AND 90+10\n          OR ss_coupon_amt BETWEEN 2323 AND 2323+1000\n          OR ss_wholesale_cost BETWEEN 31 AND 31+20)) B2,\n\n  (SELECT avg(ss_list_price) B3_LP,\n          count(ss_list_price) B3_CNT,\n          count(DISTINCT ss_list_price) B3_CNTD\n   FROM store_sales\n   WHERE ss_quantity BETWEEN 11 AND 15\n     AND (ss_list_price BETWEEN 142 AND 142+10\n          OR ss_coupon_amt BETWEEN 12214 AND 12214+1000\n          OR ss_wholesale_cost BETWEEN 79 AND 79+20)) B3,\n\n  (SELECT avg(ss_list_price) B4_LP,\n          count(ss_list_price) B4_CNT,\n          count(DISTINCT ss_list_price) B4_CNTD\n   FROM store_sales\n   WHERE ss_quantity BETWEEN 16 AND 20\n     AND (ss_list_price BETWEEN 135 AND 135+10\n          OR ss_coupon_amt BETWEEN 6071 AND 6071+1000\n          OR ss_wholesale_cost BETWEEN 38 AND 38+20)) B4,\n\n  (SELECT avg(ss_list_price) B5_LP,\n          count(ss_list_price) B5_CNT,\n          count(DISTINCT ss_list_price) B5_CNTD\n   FROM store_sales\n   WHERE ss_quantity BETWEEN 21 AND 25\n     AND (ss_list_price BETWEEN 122 AND 122+10\n          OR ss_coupon_amt BETWEEN 836 AND 836+1000\n          OR ss_wholesale_cost BETWEEN 17 AND 17+20)) B5,\n\n  (SELECT avg(ss_list_price) B6_LP,\n          count(ss_list_price) B6_CNT,\n          count(DISTINCT ss_list_price) B6_CNTD\n   FROM store_sales\n   WHERE ss_quantity BETWEEN 26 AND 30\n     AND (ss_list_price BETWEEN 154 AND 154+10\n          OR ss_coupon_amt BETWEEN 7326 AND 7326+1000\n          OR ss_wholesale_cost BETWEEN 7 AND 7+20)) B6\nLIMIT 100;"
    ],
    "29": [
        "SELECT i_item_id,\n       i_item_desc,\n       s_store_id,\n       s_store_name,\n       sum(ss_quantity) AS store_sales_quantity,\n       sum(sr_return_quantity) AS store_returns_quantity,\n       sum(cs_quantity) AS catalog_sales_quantity\nFROM store_sales,\n     store_returns,\n     catalog_sales,\n     date_dim d1,\n     date_dim d2,\n     date_dim d3,\n     store,\n     item\nWHERE d1.d_moy = 9\n  AND d1.d_year = 1999\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_moy BETWEEN 9 AND 9 + 3\n  AND d2.d_year = 1999\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\n  AND d3.d_year IN (1999,\n                    1999+1,\n                    1999+2)\nGROUP BY i_item_id,\n         i_item_desc,\n         s_store_id,\n         s_store_name\nORDER BY i_item_id,\n         i_item_desc,\n         s_store_id,\n         s_store_name\nLIMIT 100;"
    ],
    "31": [
        "WITH ss AS\n  (SELECT ca_county,\n          d_qoy,\n          d_year,\n          sum(ss_ext_sales_price) AS store_sales\n   FROM store_sales,\n        date_dim,\n        customer_address\n   WHERE ss_sold_date_sk = d_date_sk\n     AND ss_addr_sk=ca_address_sk\n   GROUP BY ca_county,\n            d_qoy,\n            d_year),\n     ws AS\n  (SELECT ca_county,\n          d_qoy,\n          d_year,\n          sum(ws_ext_sales_price) AS web_sales\n   FROM web_sales,\n        date_dim,\n        customer_address\n   WHERE ws_sold_date_sk = d_date_sk\n     AND ws_bill_addr_sk=ca_address_sk\n   GROUP BY ca_county,\n            d_qoy,\n            d_year)\nSELECT ss1.ca_county ,\n       ss1.d_year ,\n       ws2.web_sales/ws1.web_sales web_q1_q2_increase ,\n       ss2.store_sales/ss1.store_sales store_q1_q2_increase ,\n       ws3.web_sales/ws2.web_sales web_q2_q3_increase ,\n       ss3.store_sales/ss2.store_sales store_q2_q3_increase\nFROM ss ss1 ,\n     ss ss2 ,\n     ss ss3 ,\n     ws ws1 ,\n     ws ws2 ,\n     ws ws3\nWHERE ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE\n          WHEN ws1.web_sales > 0 THEN ws2.web_sales/ws1.web_sales\n          ELSE NULL\n      END > CASE\n                WHEN ss1.store_sales > 0 THEN ss2.store_sales/ss1.store_sales\n                ELSE NULL\n            END\n  AND CASE\n          WHEN ws2.web_sales > 0 THEN ws3.web_sales/ws2.web_sales\n          ELSE NULL\n      END > CASE\n                WHEN ss2.store_sales > 0 THEN ss3.store_sales/ss2.store_sales\n                ELSE NULL\n            END\nORDER BY ss1.ca_county;"
    ],
    "32": [
        "SELECT sum(cs_ext_discount_amt) AS \"excess discount amount\"\nFROM catalog_sales ,\n     item ,\n     date_dim\nWHERE i_manufact_id = 977\n  AND i_item_sk = cs_item_sk\n  AND d_date BETWEEN '2000-01-27' AND cast('2000-04-26' AS date)\n  AND d_date_sk = cs_sold_date_sk\n  AND cs_ext_discount_amt >\n    ( SELECT 1.3 * avg(cs_ext_discount_amt)\n     FROM catalog_sales ,\n          date_dim\n     WHERE cs_item_sk = i_item_sk\n       AND d_date BETWEEN '2000-01-27' AND cast('2000-04-26' AS date)\n       AND d_date_sk = cs_sold_date_sk )\nLIMIT 100;"
    ],
    "34": [
        "SELECT c_last_name ,\n       c_first_name ,\n       c_salutation ,\n       c_preferred_cust_flag ,\n       ss_ticket_number ,\n       cnt\nFROM\n  (SELECT ss_ticket_number ,\n          ss_customer_sk ,\n          count(*) cnt\n   FROM store_sales,\n        date_dim,\n        store,\n        household_demographics\n   WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     AND store_sales.ss_store_sk = store.s_store_sk\n     AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND (date_dim.d_dom BETWEEN 1 AND 3\n          OR date_dim.d_dom BETWEEN 25 AND 28)\n     AND (household_demographics.hd_buy_potential = '>10000'\n          OR household_demographics.hd_buy_potential = 'Unknown')\n     AND household_demographics.hd_vehicle_count > 0\n     AND (CASE\n              WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count\n              ELSE NULL\n          END) > 1.2\n     AND date_dim.d_year IN (1999,\n                             1999+1,\n                             1999+2)\n     AND store.s_county = 'Williamson County'\n   GROUP BY ss_ticket_number,\n            ss_customer_sk) dn,\n     customer\nWHERE ss_customer_sk = c_customer_sk\n  AND cnt BETWEEN 15 AND 20\nORDER BY c_last_name,\n         c_first_name,\n         c_salutation,\n         c_preferred_cust_flag DESC,\n         ss_ticket_number;"
    ],
    "35": [
        "SELECT ca_state,\n       cd_gender,\n       cd_marital_status,\n       cd_dep_count,\n       count(*) cnt1,\n       min(cd_dep_count),\n       max(cd_dep_count),\n       avg(cd_dep_count),\n       cd_dep_employed_count,\n       count(*) cnt2,\n       min(cd_dep_employed_count),\n       max(cd_dep_employed_count),\n       avg(cd_dep_employed_count),\n       cd_dep_college_count,\n       count(*) cnt3,\n       min(cd_dep_college_count),\n       max(cd_dep_college_count),\n       avg(cd_dep_college_count)\nFROM customer c,\n     customer_address ca,\n     customer_demographics\nWHERE c.c_current_addr_sk = ca.ca_address_sk\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS\n    (SELECT *\n     FROM store_sales,\n          date_dim\n     WHERE c.c_customer_sk = ss_customer_sk\n       AND ss_sold_date_sk = d_date_sk\n       AND d_year = 2002\n       AND d_qoy < 4)\n  AND (EXISTS\n         (SELECT *\n          FROM web_sales,\n               date_dim\n          WHERE c.c_customer_sk = ws_bill_customer_sk\n            AND ws_sold_date_sk = d_date_sk\n            AND d_year = 2002\n            AND d_qoy < 4)\n       OR EXISTS\n         (SELECT *\n          FROM catalog_sales,\n               date_dim\n          WHERE c.c_customer_sk = cs_ship_customer_sk\n            AND cs_sold_date_sk = d_date_sk\n            AND d_year = 2002\n            AND d_qoy < 4))\nGROUP BY ca_state,\n         cd_gender,\n         cd_marital_status,\n         cd_dep_count,\n         cd_dep_employed_count,\n         cd_dep_college_count\nORDER BY ca_state,\n         cd_gender,\n         cd_marital_status,\n         cd_dep_count,\n         cd_dep_employed_count,\n         cd_dep_college_count\nLIMIT 100;"
    ],
    "37": [
        "SELECT i_item_id,\n       i_item_desc,\n       i_current_price\nFROM item,\n     inventory,\n     date_dim,\n     catalog_sales\nWHERE i_current_price BETWEEN 68 AND 68 + 30\n  AND inv_item_sk = i_item_sk\n  AND d_date_sk=inv_date_sk\n  AND d_date BETWEEN cast('2000-02-01' AS date) AND cast('2000-04-01' AS date)\n  AND i_manufact_id IN (677,\n                        940,\n                        694,\n                        808)\n  AND inv_quantity_on_hand BETWEEN 100 AND 500\n  AND cs_item_sk = i_item_sk\nGROUP BY i_item_id,\n         i_item_desc,\n         i_current_price\nORDER BY i_item_id\nLIMIT 100;"
    ],
    "39a": [
        "WITH inv AS\n  (SELECT w_warehouse_name,\n          w_warehouse_sk,\n          i_item_sk,\n          d_moy,\n          stdev,\n          mean,\n          CASE mean\n              WHEN 0 THEN NULL\n              ELSE stdev/mean\n          END cov\n   FROM\n     (SELECT w_warehouse_name,\n             w_warehouse_sk,\n             i_item_sk,\n             d_moy,\n             stddev_samp(inv_quantity_on_hand) stdev,\n             avg(inv_quantity_on_hand) mean\n      FROM inventory,\n           item,\n           warehouse,\n           date_dim\n      WHERE inv_item_sk = i_item_sk\n        AND inv_warehouse_sk = w_warehouse_sk\n        AND inv_date_sk = d_date_sk\n        AND d_year =2001\n      GROUP BY w_warehouse_name,\n               w_warehouse_sk,\n               i_item_sk,\n               d_moy) foo\n   WHERE CASE mean\n             WHEN 0 THEN 0\n             ELSE stdev/mean\n         END > 1)\nSELECT inv1.w_warehouse_sk,\n       inv1.i_item_sk,\n       inv1.d_moy,\n       inv1.mean,\n       inv1.cov,\n       inv2.w_warehouse_sk,\n       inv2.i_item_sk,\n       inv2.d_moy,\n       inv2.mean,\n       inv2.cov\nFROM inv inv1,\n     inv inv2\nWHERE inv1.i_item_sk = inv2.i_item_sk\n  AND inv1.w_warehouse_sk = inv2.w_warehouse_sk\n  AND inv1.d_moy=1\n  AND inv2.d_moy=1+1\nORDER BY inv1.w_warehouse_sk,\n         inv1.i_item_sk,\n         inv1.d_moy,\n         inv1.mean,\n         inv1.cov,\n         inv2.d_moy,\n         inv2.mean,\n         inv2.cov ;"
    ],
    "39b": [
        "WITH inv AS\n  (SELECT w_warehouse_name,\n          w_warehouse_sk,\n          i_item_sk,\n          d_moy,\n          stdev,\n          mean,\n          CASE mean\n              WHEN 0 THEN NULL\n              ELSE stdev/mean\n          END cov\n   FROM\n     (SELECT w_warehouse_name,\n             w_warehouse_sk,\n             i_item_sk,\n             d_moy,\n             stddev_samp(inv_quantity_on_hand) stdev,\n             avg(inv_quantity_on_hand) mean\n      FROM inventory,\n           item,\n           warehouse,\n           date_dim\n      WHERE inv_item_sk = i_item_sk\n        AND inv_warehouse_sk = w_warehouse_sk\n        AND inv_date_sk = d_date_sk\n        AND d_year =2001\n      GROUP BY w_warehouse_name,\n               w_warehouse_sk,\n               i_item_sk,\n               d_moy) foo\n   WHERE CASE mean\n             WHEN 0 THEN 0\n             ELSE stdev/mean\n         END > 1)\nSELECT inv1.w_warehouse_sk,\n       inv1.i_item_sk,\n       inv1.d_moy,\n       inv1.mean,\n       inv1.cov,\n       inv2.w_warehouse_sk,\n       inv2.i_item_sk,\n       inv2.d_moy,\n       inv2.mean,\n       inv2.cov\nFROM inv inv1,\n     inv inv2\nWHERE inv1.i_item_sk = inv2.i_item_sk\n  AND inv1.w_warehouse_sk = inv2.w_warehouse_sk\n  AND inv1.d_moy=1\n  AND inv2.d_moy=1+1\n  AND inv1.cov > 1.5\nORDER BY inv1.w_warehouse_sk,\n         inv1.i_item_sk,\n         inv1.d_moy,\n         inv1.mean,\n         inv1.cov,\n         inv2.d_moy,\n         inv2.mean,\n         inv2.cov ;"
    ],
    "41": [
        "SELECT distinct(i_product_name)\nFROM item i1\nWHERE i_manufact_id BETWEEN 738 AND 738+40\n  AND\n    (SELECT count(*) AS item_cnt\n     FROM item\n     WHERE (i_manufact = i1.i_manufact\n            AND ((i_category = 'Women'\n                  AND (i_color = 'powder'\n                       OR i_color = 'khaki')\n                  AND (i_units = 'Ounce'\n                       OR i_units = 'Oz')\n                  AND (i_size = 'medium'\n                       OR i_size = 'extra large'))\n                 OR (i_category = 'Women'\n                     AND (i_color = 'brown'\n                          OR i_color = 'honeydew')\n                     AND (i_units = 'Bunch'\n                          OR i_units = 'Ton')\n                     AND (i_size = 'N/A'\n                          OR i_size = 'small'))\n                 OR (i_category = 'Men'\n                     AND (i_color = 'floral'\n                          OR i_color = 'deep')\n                     AND (i_units = 'N/A'\n                          OR i_units = 'Dozen')\n                     AND (i_size = 'petite'\n                          OR i_size = 'petite'))\n                 OR (i_category = 'Men'\n                     AND (i_color = 'light'\n                          OR i_color = 'cornflower')\n                     AND (i_units = 'Box'\n                          OR i_units = 'Pound')\n                     AND (i_size = 'medium'\n                          OR i_size = 'extra large'))))\n       OR (i_manufact = i1.i_manufact\n           AND ((i_category = 'Women'\n                 AND (i_color = 'midnight'\n                      OR i_color = 'snow')\n                 AND (i_units = 'Pallet'\n                      OR i_units = 'Gross')\n                 AND (i_size = 'medium'\n                      OR i_size = 'extra large'))\n                OR (i_category = 'Women'\n                    AND (i_color = 'cyan'\n                         OR i_color = 'papaya')\n                    AND (i_units = 'Cup'\n                         OR i_units = 'Dram')\n                    AND (i_size = 'N/A'\n                         OR i_size = 'small'))\n                OR (i_category = 'Men'\n                    AND (i_color = 'orange'\n                         OR i_color = 'frosted')\n                    AND (i_units = 'Each'\n                         OR i_units = 'Tbl')\n                    AND (i_size = 'petite'\n                         OR i_size = 'petite'))\n                OR (i_category = 'Men'\n                    AND (i_color = 'forest'\n                         OR i_color = 'ghost')\n                    AND (i_units = 'Lb'\n                         OR i_units = 'Bundle')\n                    AND (i_size = 'medium'\n                         OR i_size = 'extra large'))))) > 0\nORDER BY i_product_name\nLIMIT 100;"
    ],
    "42": [
        "SELECT dt.d_year,\n       item.i_category_id,\n       item.i_category,\n       sum(ss_ext_sales_price)\nFROM date_dim dt,\n     store_sales,\n     item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manager_id = 1\n  AND dt.d_moy=11\n  AND dt.d_year=2000\nGROUP BY dt.d_year,\n         item.i_category_id,\n         item.i_category\nORDER BY sum(ss_ext_sales_price) DESC,dt.d_year,\n                                      item.i_category_id,\n                                      item.i_category\nLIMIT 100 ;"
    ],
    "43": [
        "SELECT s_store_name,\n       s_store_id,\n       sum(CASE\n               WHEN (d_day_name='Sunday') THEN ss_sales_price\n               ELSE NULL\n           END) sun_sales,\n       sum(CASE\n               WHEN (d_day_name='Monday') THEN ss_sales_price\n               ELSE NULL\n           END) mon_sales,\n       sum(CASE\n               WHEN (d_day_name='Tuesday') THEN ss_sales_price\n               ELSE NULL\n           END) tue_sales,\n       sum(CASE\n               WHEN (d_day_name='Wednesday') THEN ss_sales_price\n               ELSE NULL\n           END) wed_sales,\n       sum(CASE\n               WHEN (d_day_name='Thursday') THEN ss_sales_price\n               ELSE NULL\n           END) thu_sales,\n       sum(CASE\n               WHEN (d_day_name='Friday') THEN ss_sales_price\n               ELSE NULL\n           END) fri_sales,\n       sum(CASE\n               WHEN (d_day_name='Saturday') THEN ss_sales_price\n               ELSE NULL\n           END) sat_sales\nFROM date_dim,\n     store_sales,\n     store\nWHERE d_date_sk = ss_sold_date_sk\n  AND s_store_sk = ss_store_sk\n  AND s_gmt_offset = -5\n  AND d_year = 2000\nGROUP BY s_store_name,\n         s_store_id\nORDER BY s_store_name,\n         s_store_id,\n         sun_sales,\n         mon_sales,\n         tue_sales,\n         wed_sales,\n         thu_sales,\n         fri_sales,\n         sat_sales\nLIMIT 100;"
    ],
    "45": [
        "SELECT ca_zip,\n       ca_city,\n       sum(ws_sales_price)\nFROM web_sales,\n     customer,\n     customer_address,\n     date_dim,\n     item\nWHERE ws_bill_customer_sk = c_customer_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND ws_item_sk = i_item_sk\n  AND (SUBSTR(ca_zip,1,5) IN ('85669',\n                              '86197',\n                              '88274',\n                              '83405',\n                              '86475',\n                              '85392',\n                              '85460',\n                              '80348',\n                              '81792')\n       OR i_item_id IN\n         (SELECT i_item_id\n          FROM item\n          WHERE i_item_sk IN (2,\n                              3,\n                              5,\n                              7,\n                              11,\n                              13,\n                              17,\n                              19,\n                              23,\n                              29) ))\n  AND ws_sold_date_sk = d_date_sk\n  AND d_qoy = 2\n  AND d_year = 2001\nGROUP BY ca_zip,\n         ca_city\nORDER BY ca_zip,\n         ca_city\nLIMIT 100;"
    ],
    "48": [
        "SELECT SUM(ss_quantity)\nFROM store_sales,\n     store,\n     customer_demographics,\n     customer_address,\n     date_dim\nWHERE s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 2000\n  AND ((cd_demo_sk = ss_cdemo_sk\n        AND cd_marital_status = 'M'\n        AND cd_education_status = '4 yr Degree'\n        AND ss_sales_price BETWEEN 100.00 AND 150.00)\n       OR (cd_demo_sk = ss_cdemo_sk\n           AND cd_marital_status = 'D'\n           AND cd_education_status = '2 yr Degree'\n           AND ss_sales_price BETWEEN 50.00 AND 100.00)\n       OR (cd_demo_sk = ss_cdemo_sk\n           AND cd_marital_status = 'S'\n           AND cd_education_status = 'College'\n           AND ss_sales_price BETWEEN 150.00 AND 200.00))\n  AND ((ss_addr_sk = ca_address_sk\n        AND ca_country = 'United States'\n        AND ca_state IN ('CO',\n                         'OH',\n                         'TX')\n        AND ss_net_profit BETWEEN 0 AND 2000)\n       OR (ss_addr_sk = ca_address_sk\n           AND ca_country = 'United States'\n           AND ca_state IN ('OR',\n                            'MN',\n                            'KY')\n           AND ss_net_profit BETWEEN 150 AND 3000)\n       OR (ss_addr_sk = ca_address_sk\n           AND ca_country = 'United States'\n           AND ca_state IN ('VA',\n                            'CA',\n                            'MS')\n           AND ss_net_profit BETWEEN 50 AND 25000)) ;"
    ],
    "50": [
        "SELECT s_store_name,\n       s_company_id,\n       s_street_number,\n       s_street_name,\n       s_street_type,\n       s_suite_number,\n       s_city,\n       s_county,\n       s_state,\n       s_zip,\n       sum(CASE\n               WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1\n               ELSE 0\n           END) AS \"30 days\",\n       sum(CASE\n               WHEN (sr_returned_date_sk - ss_sold_date_sk > 30)\n                    AND (sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1\n               ELSE 0\n           END) AS \"31-60 days\",\n       sum(CASE\n               WHEN (sr_returned_date_sk - ss_sold_date_sk > 60)\n                    AND (sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1\n               ELSE 0\n           END) AS \"61-90 days\",\n       sum(CASE\n               WHEN (sr_returned_date_sk - ss_sold_date_sk > 90)\n                    AND (sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1\n               ELSE 0\n           END) AS \"91-120 days\",\n       sum(CASE\n               WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1\n               ELSE 0\n           END) AS \">120 days\"\nFROM store_sales,\n     store_returns,\n     store,\n     date_dim d1,\n     date_dim d2\nWHERE d2.d_year = 2001\n  AND d2.d_moy = 8\n  AND ss_ticket_number = sr_ticket_number\n  AND ss_item_sk = sr_item_sk\n  AND ss_sold_date_sk = d1.d_date_sk\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_store_sk = s_store_sk\nGROUP BY s_store_name,\n         s_company_id,\n         s_street_number,\n         s_street_name,\n         s_street_type,\n         s_suite_number,\n         s_city,\n         s_county,\n         s_state,\n         s_zip\nORDER BY s_store_name,\n         s_company_id,\n         s_street_number,\n         s_street_name,\n         s_street_type,\n         s_suite_number,\n         s_city,\n         s_county,\n         s_state,\n         s_zip\nLIMIT 100;"
    ],
    "52": [
        "SELECT dt.d_year,\n       item.i_brand_id brand_id,\n       item.i_brand brand,\n       sum(ss_ext_sales_price) ext_price\nFROM date_dim dt,\n     store_sales,\n     item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manager_id = 1\n  AND dt.d_moy=11\n  AND dt.d_year=2000\nGROUP BY dt.d_year,\n         item.i_brand,\n         item.i_brand_id\nORDER BY dt.d_year,\n         ext_price DESC,\n         brand_id\nLIMIT 100 ;"
    ],
    "55": [
        "SELECT i_brand_id brand_id,\n       i_brand brand,\n       sum(ss_ext_sales_price) ext_price\nFROM date_dim,\n     store_sales,\n     item\nWHERE d_date_sk = ss_sold_date_sk\n  AND ss_item_sk = i_item_sk\n  AND i_manager_id=28\n  AND d_moy=11\n  AND d_year=1999\nGROUP BY i_brand,\n         i_brand_id\nORDER BY ext_price DESC,\n         i_brand_id\nLIMIT 100 ;"
    ],
    "62": [
        "SELECT w_substr,\n       sm_type,\n       web_name,\n       sum(CASE\n               WHEN (ws_ship_date_sk - ws_sold_date_sk <= 30) THEN 1\n               ELSE 0\n           END) AS \"30 days\",\n       sum(CASE\n               WHEN (ws_ship_date_sk - ws_sold_date_sk > 30)\n                    AND (ws_ship_date_sk - ws_sold_date_sk <= 60) THEN 1\n               ELSE 0\n           END) AS \"31-60 days\",\n       sum(CASE\n               WHEN (ws_ship_date_sk - ws_sold_date_sk > 60)\n                    AND (ws_ship_date_sk - ws_sold_date_sk <= 90) THEN 1\n               ELSE 0\n           END) AS \"61-90 days\",\n       sum(CASE\n               WHEN (ws_ship_date_sk - ws_sold_date_sk > 90)\n                    AND (ws_ship_date_sk - ws_sold_date_sk <= 120) THEN 1\n               ELSE 0\n           END) AS \"91-120 days\",\n       sum(CASE\n               WHEN (ws_ship_date_sk - ws_sold_date_sk > 120) THEN 1\n               ELSE 0\n           END) AS \">120 days\"\nFROM web_sales,\n  (SELECT SUBSTR(w_warehouse_name,1,20) w_substr, *\n   FROM warehouse) sq1,\n     ship_mode,\n     web_site,\n     date_dim\nWHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n  AND ws_ship_date_sk = d_date_sk\n  AND ws_warehouse_sk = w_warehouse_sk\n  AND ws_ship_mode_sk = sm_ship_mode_sk\n  AND ws_web_site_sk = web_site_sk\nGROUP BY w_substr,\n         sm_type,\n         web_name\nORDER BY w_substr,\n         sm_type,\n         web_name\nLIMIT 100;"
    ],
    "65": [
        "SELECT s_store_name,\n       i_item_desc,\n       sc.revenue,\n       i_current_price,\n       i_wholesale_cost,\n       i_brand\nFROM store,\n     item,\n\n  (SELECT ss_store_sk,\n          avg(revenue) AS ave\n   FROM\n     (SELECT ss_store_sk,\n             ss_item_sk,\n             sum(ss_sales_price) AS revenue\n      FROM store_sales,\n           date_dim\n      WHERE ss_sold_date_sk = d_date_sk\n        AND d_month_seq BETWEEN 1176 AND 1176+11\n      GROUP BY ss_store_sk,\n               ss_item_sk) sa\n   GROUP BY ss_store_sk) sb,\n\n  (SELECT ss_store_sk,\n          ss_item_sk,\n          sum(ss_sales_price) AS revenue\n   FROM store_sales,\n        date_dim\n   WHERE ss_sold_date_sk = d_date_sk\n     AND d_month_seq BETWEEN 1176 AND 1176+11\n   GROUP BY ss_store_sk,\n            ss_item_sk) sc\nWHERE sb.ss_store_sk = sc.ss_store_sk\n  AND sc.revenue <= 0.1 * sb.ave\n  AND s_store_sk = sc.ss_store_sk\n  AND i_item_sk = sc.ss_item_sk\nORDER BY s_store_name,\n         i_item_desc\nLIMIT 100;"
    ],
    "69": [
        "SELECT cd_gender,\n       cd_marital_status,\n       cd_education_status,\n       count(*) cnt1,\n       cd_purchase_estimate,\n       count(*) cnt2,\n       cd_credit_rating,\n       count(*) cnt3\nFROM customer c,\n     customer_address ca,\n     customer_demographics\nWHERE c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_state IN ('KY',\n                   'GA',\n                   'NM')\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS\n    (SELECT *\n     FROM store_sales,\n          date_dim\n     WHERE c.c_customer_sk = ss_customer_sk\n       AND ss_sold_date_sk = d_date_sk\n       AND d_year = 2001\n       AND d_moy BETWEEN 4 AND 4+2)\n  AND (NOT EXISTS\n         (SELECT *\n          FROM web_sales,\n               date_dim\n          WHERE c.c_customer_sk = ws_bill_customer_sk\n            AND ws_sold_date_sk = d_date_sk\n            AND d_year = 2001\n            AND d_moy BETWEEN 4 AND 4+2)\n       AND NOT EXISTS\n         (SELECT *\n          FROM catalog_sales,\n               date_dim\n          WHERE c.c_customer_sk = cs_ship_customer_sk\n            AND cs_sold_date_sk = d_date_sk\n            AND d_year = 2001\n            AND d_moy BETWEEN 4 AND 4+2))\nGROUP BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating\nORDER BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating\nLIMIT 100;"
    ],
    "73": [
        "SELECT c_last_name,\n       c_first_name,\n       c_salutation,\n       c_preferred_cust_flag,\n       ss_ticket_number,\n       cnt\nFROM\n  (SELECT ss_ticket_number,\n          ss_customer_sk,\n          count(*) cnt\n   FROM store_sales,\n        date_dim,\n        store,\n        household_demographics\n   WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     AND store_sales.ss_store_sk = store.s_store_sk\n     AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND date_dim.d_dom BETWEEN 1 AND 2\n     AND (household_demographics.hd_buy_potential = 'Unknown'\n          OR household_demographics.hd_buy_potential = '>10000')\n     AND household_demographics.hd_vehicle_count > 0\n     AND CASE\n             WHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count\n             ELSE NULL\n         END > 1\n     AND date_dim.d_year IN (1999,\n                             1999+1,\n                             1999+2)\n     AND store.s_county IN ('Orange County',\n                            'Bronx County',\n                            'Franklin Parish',\n                            'Williamson County')\n   GROUP BY ss_ticket_number,\n            ss_customer_sk) dj,\n     customer\nWHERE ss_customer_sk = c_customer_sk\n  AND cnt BETWEEN 1 AND 5\nORDER BY cnt DESC,\n         c_last_name ASC;"
    ],
    "79": [
        "SELECT c_last_name,\n       c_first_name,\n       SUBSTR(s_city,1,30),\n       ss_ticket_number,\n       amt,\n       profit\nFROM\n  (SELECT ss_ticket_number ,\n          ss_customer_sk ,\n          store.s_city ,\n          sum(ss_coupon_amt) amt ,\n          sum(ss_net_profit) profit\n   FROM store_sales,\n        date_dim,\n        store,\n        household_demographics\n   WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     AND store_sales.ss_store_sk = store.s_store_sk\n     AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND (household_demographics.hd_dep_count = 6\n          OR household_demographics.hd_vehicle_count > 2)\n     AND date_dim.d_dow = 1\n     AND date_dim.d_year IN (1999,\n                             1999+1,\n                             1999+2)\n     AND store.s_number_employees BETWEEN 200 AND 295\n   GROUP BY ss_ticket_number,\n            ss_customer_sk,\n            ss_addr_sk,\n            store.s_city) ms,\n     customer\nWHERE ss_customer_sk = c_customer_sk\nORDER BY c_last_name,\n         c_first_name,\n         SUBSTR(s_city,1,30),\n         profit\nLIMIT 100;"
    ],
    "81": [
        "WITH customer_total_return AS\n  (SELECT cr_returning_customer_sk AS ctr_customer_sk ,\n          ca_state AS ctr_state,\n          sum(cr_return_amt_inc_tax) AS ctr_total_return\n   FROM catalog_returns ,\n        date_dim ,\n        customer_address\n   WHERE cr_returned_date_sk = d_date_sk\n     AND d_year = 2000\n     AND cr_returning_addr_sk = ca_address_sk\n   GROUP BY cr_returning_customer_sk ,\n            ca_state)\nSELECT c_customer_id,\n       c_salutation,\n       c_first_name,\n       c_last_name,\n       ca_street_number,\n       ca_street_name ,\n       ca_street_type,\n       ca_suite_number,\n       ca_city,\n       ca_county,\n       ca_state,\n       ca_zip,\n       ca_country,\n       ca_gmt_offset ,\n       ca_location_type,\n       ctr_total_return\nFROM customer_total_return ctr1 ,\n     customer_address ,\n     customer\nWHERE ctr1.ctr_total_return >\n    (SELECT avg(ctr_total_return)*1.2\n     FROM customer_total_return ctr2\n     WHERE ctr1.ctr_state = ctr2.ctr_state)\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'GA'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY c_customer_id,\n         c_salutation,\n         c_first_name,\n         c_last_name,\n         ca_street_number,\n         ca_street_name ,\n         ca_street_type,\n         ca_suite_number,\n         ca_city,\n         ca_county,\n         ca_state,\n         ca_zip,\n         ca_country,\n         ca_gmt_offset ,\n         ca_location_type,\n         ctr_total_return\nLIMIT 100;"
    ],
    "82": [
        "SELECT i_item_id ,\n       i_item_desc ,\n       i_current_price\nFROM item,\n     inventory,\n     date_dim,\n     store_sales\nWHERE i_current_price BETWEEN 62 AND 62+30\n  AND inv_item_sk = i_item_sk\n  AND d_date_sk=inv_date_sk\n  AND d_date BETWEEN cast('2000-05-25' AS date) AND cast('2000-07-24' AS date)\n  AND i_manufact_id IN (129,\n                        270,\n                        821,\n                        423)\n  AND inv_quantity_on_hand BETWEEN 100 AND 500\n  AND ss_item_sk = i_item_sk\nGROUP BY i_item_id,\n         i_item_desc,\n         i_current_price\nORDER BY i_item_id\nLIMIT 100;"
    ],
    "83": [
        "WITH sr_items AS\n  (SELECT i_item_id item_id,\n          sum(sr_return_quantity) sr_item_qty\n   FROM store_returns,\n        item,\n        date_dim\n   WHERE sr_item_sk = i_item_sk\n     AND d_date IN\n       (SELECT d_date\n        FROM date_dim\n        WHERE d_week_seq IN\n            (SELECT d_week_seq\n             FROM date_dim\n             WHERE d_date IN ('2000-06-30',\n                              '2000-09-27',\n                              '2000-11-17')))\n     AND sr_returned_date_sk = d_date_sk\n   GROUP BY i_item_id),\n     cr_items AS\n  (SELECT i_item_id item_id,\n          sum(cr_return_quantity) cr_item_qty\n   FROM catalog_returns,\n        item,\n        date_dim\n   WHERE cr_item_sk = i_item_sk\n     AND d_date IN\n       (SELECT d_date\n        FROM date_dim\n        WHERE d_week_seq IN\n            (SELECT d_week_seq\n             FROM date_dim\n             WHERE d_date IN ('2000-06-30',\n                              '2000-09-27',\n                              '2000-11-17')))\n     AND cr_returned_date_sk = d_date_sk\n   GROUP BY i_item_id),\n     wr_items AS\n  (SELECT i_item_id item_id,\n          sum(wr_return_quantity) wr_item_qty\n   FROM web_returns,\n        item,\n        date_dim\n   WHERE wr_item_sk = i_item_sk\n     AND d_date IN\n       (SELECT d_date\n        FROM date_dim\n        WHERE d_week_seq IN\n            (SELECT d_week_seq\n             FROM date_dim\n             WHERE d_date IN ('2000-06-30',\n                              '2000-09-27',\n                              '2000-11-17')))\n     AND wr_returned_date_sk = d_date_sk\n   GROUP BY i_item_id)\nSELECT sr_items.item_id ,\n       sr_item_qty ,\n       (sr_item_qty*1.0000)/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0000 * 100 sr_dev ,\n       cr_item_qty ,\n       (cr_item_qty*1.0000)/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0000 * 100 cr_dev ,\n       wr_item_qty ,\n       (wr_item_qty*1.0000)/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0000 * 100 wr_dev ,\n       (sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\nFROM sr_items ,\n     cr_items ,\n     wr_items\nWHERE sr_items.item_id=cr_items.item_id\n  AND sr_items.item_id=wr_items.item_id\nORDER BY sr_items.item_id ,\n         sr_item_qty\nLIMIT 100;"
    ],
    "85": [
        "SELECT SUBSTR(r_reason_desc,1,20) ,\n       avg(ws_quantity) ,\n       avg(wr_refunded_cash) ,\n       avg(wr_fee)\nFROM web_sales,\n     web_returns,\n     web_page,\n     customer_demographics cd1,\n     customer_demographics cd2,\n     customer_address,\n     date_dim,\n     reason\nWHERE ws_web_page_sk = wp_web_page_sk\n  AND ws_item_sk = wr_item_sk\n  AND ws_order_number = wr_order_number\n  AND ws_sold_date_sk = d_date_sk\n  AND d_year = 2000\n  AND cd1.cd_demo_sk = wr_refunded_cdemo_sk\n  AND cd2.cd_demo_sk = wr_returning_cdemo_sk\n  AND ca_address_sk = wr_refunded_addr_sk\n  AND r_reason_sk = wr_reason_sk\n  AND ( ( cd1.cd_marital_status = 'M'\n         AND cd1.cd_marital_status = cd2.cd_marital_status\n         AND cd1.cd_education_status = 'Advanced Degree'\n         AND cd1.cd_education_status = cd2.cd_education_status\n         AND ws_sales_price BETWEEN 100.00 AND 150.00 )\n       OR ( cd1.cd_marital_status = 'S'\n           AND cd1.cd_marital_status = cd2.cd_marital_status\n           AND cd1.cd_education_status = 'College'\n           AND cd1.cd_education_status = cd2.cd_education_status\n           AND ws_sales_price BETWEEN 50.00 AND 100.00 )\n       OR ( cd1.cd_marital_status = 'W'\n           AND cd1.cd_marital_status = cd2.cd_marital_status\n           AND cd1.cd_education_status = '2 yr Degree'\n           AND cd1.cd_education_status = cd2.cd_education_status\n           AND ws_sales_price BETWEEN 150.00 AND 200.00 ) )\n  AND ( ( ca_country = 'United States'\n         AND ca_state IN ('IN',\n                          'OH',\n                          'NJ')\n         AND ws_net_profit BETWEEN 100 AND 200)\n       OR ( ca_country = 'United States'\n           AND ca_state IN ('WI',\n                            'CT',\n                            'KY')\n           AND ws_net_profit BETWEEN 150 AND 300)\n       OR ( ca_country = 'United States'\n           AND ca_state IN ('LA',\n                            'IA',\n                            'AR')\n           AND ws_net_profit BETWEEN 50 AND 250) )\nGROUP BY r_reason_desc\nORDER BY SUBSTR(r_reason_desc,1,20) ,\n         avg(ws_quantity) ,\n         avg(wr_refunded_cash) ,\n         avg(wr_fee)\nLIMIT 100;"
    ],
    "88": [
        "SELECT *\nFROM\n  (SELECT count(*) h8_30_to_9\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 8\n     AND time_dim.t_minute >= 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s1,\n\n  (SELECT count(*) h9_to_9_30\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 9\n     AND time_dim.t_minute < 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s2,\n\n  (SELECT count(*) h9_30_to_10\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 9\n     AND time_dim.t_minute >= 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s3,\n\n  (SELECT count(*) h10_to_10_30\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 10\n     AND time_dim.t_minute < 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s4,\n\n  (SELECT count(*) h10_30_to_11\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 10\n     AND time_dim.t_minute >= 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s5,\n\n  (SELECT count(*) h11_to_11_30\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 11\n     AND time_dim.t_minute < 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s6,\n\n  (SELECT count(*) h11_30_to_12\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 11\n     AND time_dim.t_minute >= 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s7,\n\n  (SELECT count(*) h12_to_12_30\n   FROM store_sales,\n        household_demographics,\n        time_dim,\n        store\n   WHERE ss_sold_time_sk = time_dim.t_time_sk\n     AND ss_hdemo_sk = household_demographics.hd_demo_sk\n     AND ss_store_sk = s_store_sk\n     AND time_dim.t_hour = 12\n     AND time_dim.t_minute < 30\n     AND ((household_demographics.hd_dep_count = 4\n           AND household_demographics.hd_vehicle_count<=4+2)\n          OR (household_demographics.hd_dep_count = 2\n              AND household_demographics.hd_vehicle_count<=2+2)\n          OR (household_demographics.hd_dep_count = 0\n              AND household_demographics.hd_vehicle_count<=0+2))\n     AND store.s_store_name = 'ese') s8 ;"
    ],
    "91": [
        "SELECT cc_call_center_id Call_Center,\n       cc_name Call_Center_Name,\n       cc_manager Manager,\n       sum(cr_net_loss) Returns_Loss\nFROM call_center,\n     catalog_returns,\n     date_dim,\n     customer,\n     customer_address,\n     customer_demographics,\n     household_demographics\nWHERE cr_call_center_sk = cc_call_center_sk\n  AND cr_returned_date_sk = d_date_sk\n  AND cr_returning_customer_sk= c_customer_sk\n  AND cd_demo_sk = c_current_cdemo_sk\n  AND hd_demo_sk = c_current_hdemo_sk\n  AND ca_address_sk = c_current_addr_sk\n  AND d_year = 1998\n  AND d_moy = 11\n  AND ((cd_marital_status = 'M'\n        AND cd_education_status = 'Unknown') or(cd_marital_status = 'W'\n                                                AND cd_education_status = 'Advanced Degree'))\n  AND hd_buy_potential LIKE 'Unknown%'\n  AND ca_gmt_offset = -7\nGROUP BY cc_call_center_id,\n         cc_name,\n         cc_manager,\n         cd_marital_status,\n         cd_education_status\nORDER BY sum(cr_net_loss) DESC;"
    ],
    "92": [
        "SELECT sum(ws_ext_discount_amt) AS \"Excess Discount Amount\"\nFROM web_sales,\n     item,\n     date_dim\nWHERE i_manufact_id = 350\n  AND i_item_sk = ws_item_sk\n  AND d_date BETWEEN '2000-01-27' AND cast('2000-04-26' AS date)\n  AND d_date_sk = ws_sold_date_sk\n  AND ws_ext_discount_amt >\n    (SELECT 1.3 * avg(ws_ext_discount_amt)\n     FROM web_sales,\n          date_dim\n     WHERE ws_item_sk = i_item_sk\n       AND d_date BETWEEN '2000-01-27' AND cast('2000-04-26' AS date)\n       AND d_date_sk = ws_sold_date_sk )\nORDER BY sum(ws_ext_discount_amt)\nLIMIT 100;"
    ],
    "93": [
        "SELECT ss_customer_sk,\n       sum(act_sales) sumsales\nFROM\n  (SELECT ss_item_sk,\n          ss_ticket_number,\n          ss_customer_sk,\n          CASE\n              WHEN sr_return_quantity IS NOT NULL THEN (ss_quantity-sr_return_quantity)*ss_sales_price\n              ELSE (ss_quantity*ss_sales_price)\n          END act_sales\n   FROM store_sales\n   LEFT OUTER JOIN store_returns ON (sr_item_sk = ss_item_sk\n                                     AND sr_ticket_number = ss_ticket_number) ,reason\n   WHERE sr_reason_sk = r_reason_sk\n     AND r_reason_desc = 'reason 28') t\nGROUP BY ss_customer_sk\nORDER BY sumsales,\n         ss_customer_sk\nLIMIT 100;"
    ],
    "94": [
        "SELECT count(DISTINCT ws_order_number) AS \"order count\" ,\n       sum(ws_ext_ship_cost) AS \"total shipping cost\" ,\n       sum(ws_net_profit) AS \"total net profit\"\nFROM web_sales ws1 ,\n     date_dim ,\n     customer_address ,\n     web_site\nWHERE d_date BETWEEN '1999-02-01' AND cast('1999-04-02' AS date)\n  AND ws1.ws_ship_date_sk = d_date_sk\n  AND ws1.ws_ship_addr_sk = ca_address_sk\n  AND ca_state = 'IL'\n  AND ws1.ws_web_site_sk = web_site_sk\n  AND web_company_name = 'pri'\n  AND EXISTS\n    (SELECT *\n     FROM web_sales ws2\n     WHERE ws1.ws_order_number = ws2.ws_order_number\n       AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n  AND NOT exists\n    (SELECT *\n     FROM web_returns wr1\n     WHERE ws1.ws_order_number = wr1.wr_order_number)\nORDER BY count(DISTINCT ws_order_number)\nLIMIT 100;"
    ],
    "95": [
        "WITH ws_wh AS\n  (SELECT ws1.ws_order_number,\n          ws1.ws_warehouse_sk wh1,\n          ws2.ws_warehouse_sk wh2\n   FROM web_sales ws1,\n        web_sales ws2\n   WHERE ws1.ws_order_number = ws2.ws_order_number\n     AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nSELECT count(DISTINCT ws_order_number) AS \"order count\" ,\n       sum(ws_ext_ship_cost) AS \"total shipping cost\" ,\n       sum(ws_net_profit) AS \"total net profit\"\nFROM web_sales ws1 ,\n     date_dim ,\n     customer_address ,\n     web_site\nWHERE d_date BETWEEN '1999-02-01' AND cast('1999-04-02' AS date)\n  AND ws1.ws_ship_date_sk = d_date_sk\n  AND ws1.ws_ship_addr_sk = ca_address_sk\n  AND ca_state = 'IL'\n  AND ws1.ws_web_site_sk = web_site_sk\n  AND web_company_name = 'pri'\n  AND ws1.ws_order_number IN\n    (SELECT ws_order_number\n     FROM ws_wh)\n  AND ws1.ws_order_number IN\n    (SELECT wr_order_number\n     FROM web_returns,\n          ws_wh\n     WHERE wr_order_number = ws_wh.ws_order_number)\nORDER BY count(DISTINCT ws_order_number)\nLIMIT 100;"
    ],
    "96": [
        "SELECT count(*)\nFROM store_sales ,\n     household_demographics,\n     time_dim,\n     store\nWHERE ss_sold_time_sk = time_dim.t_time_sk\n  AND ss_hdemo_sk = household_demographics.hd_demo_sk\n  AND ss_store_sk = s_store_sk\n  AND time_dim.t_hour = 20\n  AND time_dim.t_minute >= 30\n  AND household_demographics.hd_dep_count = 7\n  AND store.s_store_name = 'ese'\nORDER BY count(*)\nLIMIT 100;"
    ],
    "97": [
        "WITH ssci AS\n  (SELECT ss_customer_sk customer_sk ,\n          ss_item_sk item_sk\n   FROM store_sales,\n        date_dim\n   WHERE ss_sold_date_sk = d_date_sk\n     AND d_month_seq BETWEEN 1200 AND 1200 + 11\n   GROUP BY ss_customer_sk ,\n            ss_item_sk),\n     csci as\n  ( SELECT cs_bill_customer_sk customer_sk ,cs_item_sk item_sk\n   FROM catalog_sales,date_dim\n   WHERE cs_sold_date_sk = d_date_sk\n     AND d_month_seq BETWEEN 1200 AND 1200 + 11\n   GROUP BY cs_bill_customer_sk ,cs_item_sk)\nSELECT sum(CASE\n               WHEN ssci.customer_sk IS NOT NULL\n                    AND csci.customer_sk IS NULL THEN 1\n               ELSE 0\n           END) store_only ,\n       sum(CASE\n               WHEN ssci.customer_sk IS NULL\n                    AND csci.customer_sk IS NOT NULL THEN 1\n               ELSE 0\n           END) catalog_only ,\n       sum(CASE\n               WHEN ssci.customer_sk IS NOT NULL\n                    AND csci.customer_sk IS NOT NULL THEN 1\n               ELSE 0\n           END) store_and_catalog\nFROM ssci\nFULL OUTER JOIN csci ON (ssci.customer_sk=csci.customer_sk\n                         AND ssci.item_sk = csci.item_sk)\nLIMIT 100;"
    ],
    "99": [
        "SELECT w_substr ,\n       sm_type ,\n       cc_name ,\n       sum(CASE\n               WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1\n               ELSE 0\n           END) AS \"30 days\",\n       sum(CASE\n               WHEN (cs_ship_date_sk - cs_sold_date_sk > 30)\n                    AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1\n               ELSE 0\n           END) AS \"31-60 days\",\n       sum(CASE\n               WHEN (cs_ship_date_sk - cs_sold_date_sk > 60)\n                    AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1\n               ELSE 0\n           END) AS \"61-90 days\",\n       sum(CASE\n               WHEN (cs_ship_date_sk - cs_sold_date_sk > 90)\n                    AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1\n               ELSE 0\n           END) AS \"91-120 days\",\n       sum(CASE\n               WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1\n               ELSE 0\n           END) AS \">120 days\"\nFROM catalog_sales ,\n  (SELECT SUBSTR(w_warehouse_name,1,20) w_substr, *\n   FROM warehouse) AS sq1 ,\n     ship_mode ,\n     call_center ,\n     date_dim\nWHERE d_month_seq BETWEEN 1200 AND 1200 + 11\n  AND cs_ship_date_sk = d_date_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_ship_mode_sk = sm_ship_mode_sk\n  AND cs_call_center_sk = cc_call_center_sk\nGROUP BY w_substr ,\n         sm_type ,\n         cc_name\nORDER BY w_substr ,\n         sm_type ,\n         cc_name\nLIMIT 100;"
    ]
}
